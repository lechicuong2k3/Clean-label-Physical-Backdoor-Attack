ResNet50 model initialized with random key 23456.
Hyperparameters(name='conservative', epochs=40, batch_size=64, optimizer='Adam', lr=0.0001, scheduler='linear', weight_decay=0.0005, augmentations='default', privacy={'clip': None, 'noise': None, 'distribution': None}, validate=10, novel_defense=None, mixing_method=None, adaptive_attack=True, defend_features_only=False)
Preparing dataset from source class for crafting poisons...
Number of samples that can be selected for poisoning is 258
Starting clean training with finetuning scenario ...
Epoch: 1  | lr: 0.0001 | Training loss:  0.3384, Training accuracy: 90.1909% | 
Epoch: 2  | lr: 0.0001 | Training loss:  0.0294, Training accuracy: 99.0266% | 
Epoch: 3  | lr: 0.0001 | Training loss:  0.0447, Training accuracy: 98.7645% | 
Epoch: 4  | lr: 0.0001 | Training loss:  0.0206, Training accuracy: 99.3635% | 
Epoch: 5  | lr: 0.0001 | Training loss:  0.0041, Training accuracy: 100.0000% | 
Epoch: 6  | lr: 0.0001 | Training loss:  0.0014, Training accuracy: 100.0000% | 
Epoch: 7  | lr: 0.0001 | Training loss:  0.0022, Training accuracy: 99.9251% | 
Epoch: 8  | lr: 0.0001 | Training loss:  0.0021, Training accuracy: 99.9251% | 
Epoch: 9  | lr: 0.0001 | Training loss:  0.0060, Training accuracy: 99.8877% | 
Epoch: 10 | lr: 0.0001 | Training loss:  0.0286, Training accuracy: 99.0640% | 
------------- Validation -------------
Validation  loss :  0.2063 | Validation accuracy: 93.4621%
Target val. acc  : 90.7692% | Source val accuracy: 93.7500%
Source class: 0
Backdoor loss:  6.9054 | Backdoor acc: 0.0000%
Clean    loss:  1.3935 | Clean    acc: 56.5611%
Source class: 2
Backdoor loss:  5.0298 | Backdoor acc: 0.0000%
Clean    loss:  1.6079 | Clean    acc: 42.3729%
Source class: 3
Backdoor loss:  4.8199 | Backdoor acc: 7.6923%
Clean    loss:  4.7248 | Clean    acc: 33.3333%
Source class: 4
Backdoor loss:  7.8565 | Backdoor acc: 0.0000%
Clean    loss:  1.4399 | Clean    acc: 50.0000%
Source class: 5
Backdoor loss:  5.1532 | Backdoor acc: 0.0000%
Clean    loss:  2.4018 | Clean    acc: 29.6875%
Source class: 6
Backdoor loss:  9.0706 | Backdoor acc: 0.0000%
Clean    loss:  3.4225 | Clean    acc: 46.0993%
Source class: 7
Backdoor loss:  5.5637 | Backdoor acc: 0.0000%
Clean    loss:  1.4361 | Clean    acc: 43.6782%
Source class: 8
Backdoor loss:  9.5522 | Backdoor acc: 0.0000%
Clean    loss:  0.7029 | Clean    acc: 82.1862%
Source class: 9
Backdoor loss:  7.3160 | Backdoor acc: 3.8835%
Clean    loss:  0.2663 | Clean    acc: 92.2330%
Average:
Backdoor loss:  7.2184 | Backdoor acc: 1.0542%
Clean    loss:  1.6239 | Clean    acc: 59.1867%
--------------------------------------
Epoch: 11 | lr: 0.0001 | Training loss:  0.0490, Training accuracy: 98.5773% | 
Epoch: 12 | lr: 0.0001 | Training loss:  0.0453, Training accuracy: 98.7645% | 
Epoch: 13 | lr: 0.0001 | Training loss:  0.0267, Training accuracy: 99.1763% | 
Epoch: 14 | lr: 0.0000 | Training loss:  0.0112, Training accuracy: 99.5882% | 
Epoch: 15 | lr: 0.0000 | Training loss:  0.0030, Training accuracy: 99.9626% | 
Epoch: 16 | lr: 0.0000 | Training loss:  0.0026, Training accuracy: 99.9251% | 
Epoch: 17 | lr: 0.0000 | Training loss:  0.0033, Training accuracy: 99.9251% | 
Epoch: 18 | lr: 0.0000 | Training loss:  0.0009, Training accuracy: 100.0000% | 
Epoch: 19 | lr: 0.0000 | Training loss:  0.0031, Training accuracy: 99.9626% | 
Epoch: 20 | lr: 0.0000 | Training loss:  0.0012, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.0788 | Validation accuracy: 97.7712%
Target val. acc  : 95.3846% | Source val accuracy: 98.0263%
Source class: 0
Backdoor loss: 15.8599 | Backdoor acc: 0.0000%
Clean    loss:  2.5225 | Clean    acc: 74.6606%
Source class: 2
Backdoor loss:  4.9227 | Backdoor acc: 0.0000%
Clean    loss:  0.3266 | Clean    acc: 97.4576%
Source class: 3
Backdoor loss:  7.5437 | Backdoor acc: 7.6923%
Clean    loss:  3.5037 | Clean    acc: 48.7179%
Source class: 4
Backdoor loss: 14.5446 | Backdoor acc: 0.0000%
Clean    loss:  0.0292 | Clean    acc: 100.0000%
Source class: 5
Backdoor loss:  7.8577 | Backdoor acc: 0.7812%
Clean    loss:  0.9854 | Clean    acc: 68.7500%
Source class: 6
Backdoor loss: 10.4541 | Backdoor acc: 0.0000%
Clean    loss:  3.5371 | Clean    acc: 46.8085%
Source class: 7
Backdoor loss:  6.4026 | Backdoor acc: 0.0000%
Clean    loss:  2.2630 | Clean    acc: 31.0345%
Source class: 8
Backdoor loss:  9.9678 | Backdoor acc: 0.0000%
Clean    loss:  0.8966 | Clean    acc: 81.3765%
Source class: 9
Backdoor loss:  8.3928 | Backdoor acc: 0.4854%
Clean    loss:  0.4080 | Clean    acc: 86.4078%
Average:
Backdoor loss: 10.0796 | Backdoor acc: 0.6024%
Clean    loss:  1.5057 | Clean    acc: 73.7952%
--------------------------------------
Epoch: 21 | lr: 0.0000 | Training loss:  0.0016, Training accuracy: 99.9626% | 
Epoch: 22 | lr: 0.0000 | Training loss:  0.0008, Training accuracy: 100.0000% | 
Epoch: 23 | lr: 0.0000 | Training loss:  0.0013, Training accuracy: 99.9626% | 
Epoch: 24 | lr: 0.0000 | Training loss:  0.0005, Training accuracy: 100.0000% | 
Epoch: 25 | lr: 0.0000 | Training loss:  0.0005, Training accuracy: 100.0000% | 
Epoch: 26 | lr: 0.0000 | Training loss:  0.0013, Training accuracy: 99.9626% | 
Epoch: 27 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 28 | lr: 0.0000 | Training loss:  0.0005, Training accuracy: 100.0000% | 
Epoch: 29 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 100.0000% | 
Epoch: 30 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.0907 | Validation accuracy: 96.4339%
Target val. acc  : 96.9231% | Source val accuracy: 96.3816%
Source class: 0
Backdoor loss: 15.0970 | Backdoor acc: 0.0000%
Clean    loss:  1.9671 | Clean    acc: 74.6606%
Source class: 2
Backdoor loss:  5.6040 | Backdoor acc: 0.0000%
Clean    loss:  0.2023 | Clean    acc: 100.0000%
Source class: 3
Backdoor loss:  6.7287 | Backdoor acc: 7.6923%
Clean    loss:  3.3334 | Clean    acc: 47.4359%
Source class: 4
Backdoor loss: 14.3140 | Backdoor acc: 0.0000%
Clean    loss:  0.0541 | Clean    acc: 97.0588%
Source class: 5
Backdoor loss:  7.2388 | Backdoor acc: 0.7812%
Clean    loss:  1.3643 | Clean    acc: 54.6875%
Source class: 6
Backdoor loss: 10.0543 | Backdoor acc: 0.0000%
Clean    loss:  4.0781 | Clean    acc: 46.8085%
Source class: 7
Backdoor loss:  6.5571 | Backdoor acc: 0.0000%
Clean    loss:  1.8096 | Clean    acc: 45.9770%
Source class: 8
Backdoor loss: 11.5708 | Backdoor acc: 0.0000%
Clean    loss:  0.7731 | Clean    acc: 85.0202%
Source class: 9
Backdoor loss:  8.1740 | Backdoor acc: 0.4854%
Clean    loss:  0.3614 | Clean    acc: 88.8350%
Average:
Backdoor loss: 10.1198 | Backdoor acc: 0.6024%
Clean    loss:  1.4282 | Clean    acc: 74.3976%
--------------------------------------
Epoch: 31 | lr: 0.0000 | Training loss:  0.0019, Training accuracy: 99.9626% | 
Epoch: 32 | lr: 0.0000 | Training loss:  0.0003, Training accuracy: 100.0000% | 
Epoch: 33 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 100.0000% | 
Epoch: 34 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 35 | lr: 0.0000 | Training loss:  0.0008, Training accuracy: 100.0000% | 
Epoch: 36 | lr: 0.0000 | Training loss:  0.0007, Training accuracy: 100.0000% | 
Epoch: 37 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 38 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 39 | lr: 0.0000 | Training loss:  0.0005, Training accuracy: 100.0000% | 
Epoch: 40 | lr: 0.0000 | Training loss:  0.0011, Training accuracy: 99.9626% | 
------------- Validation -------------
Validation  loss :  0.0772 | Validation accuracy: 97.4740%
Target val. acc  : 96.9231% | Source val accuracy: 97.5329%
Source class: 0
Backdoor loss: 15.2480 | Backdoor acc: 0.0000%
Clean    loss:  1.5623 | Clean    acc: 74.6606%
Source class: 2
Backdoor loss:  5.4099 | Backdoor acc: 0.0000%
Clean    loss:  0.2280 | Clean    acc: 99.1525%
Source class: 3
Backdoor loss:  6.9544 | Backdoor acc: 8.9744%
Clean    loss:  3.4056 | Clean    acc: 47.4359%
Source class: 4
Backdoor loss: 14.3145 | Backdoor acc: 0.0000%
Clean    loss:  0.0475 | Clean    acc: 98.0392%
Source class: 5
Backdoor loss:  6.7141 | Backdoor acc: 0.7812%
Clean    loss:  1.7338 | Clean    acc: 42.1875%
Source class: 6
Backdoor loss: 10.6240 | Backdoor acc: 0.0000%
Clean    loss:  3.9512 | Clean    acc: 46.8085%
Source class: 7
Backdoor loss:  6.4072 | Backdoor acc: 0.0000%
Clean    loss:  1.8995 | Clean    acc: 43.6782%
Source class: 8
Backdoor loss: 11.2461 | Backdoor acc: 0.0000%
Clean    loss:  0.7806 | Clean    acc: 84.6154%
Source class: 9
Backdoor loss:  7.9962 | Backdoor acc: 0.4854%
Clean    loss:  0.4175 | Clean    acc: 87.3786%
Average:
Backdoor loss: 10.0531 | Backdoor acc: 0.6777%
Clean    loss:  1.4050 | Clean    acc: 72.7410%
--------------------------------------
False positive rate: 2.0000% | Suspicion rate: 0.5762%
Feature representation saved.
Add 52 bonus images of target class with physical trigger to training set.

--------------- Poisoning setup ---------------
--Target/Poison class: 1 (cuong)
--Threat model: clean-multi-source
--Poison selection: max_gradient
--Alpha: 0 images - 0.00% of target-class trainset and 0.00% of total trainset
--Beta: 52 images - 20.00% of target-class trainset

--Source class: 0,2,3,4,5,6,7,8,9 (chi,dung,khiem,long,nhan,son,thinh,tuan,vu)
--Attacker's source_trainset: 1328 images
--Attacker's source_testset: 1328 images
----------------------------------------------

Validating poisoned model...
ResNet50 model initialized with random key 2543789753.
Hyperparameters(name='conservative', epochs=40, batch_size=64, optimizer='Adam', lr=0.0001, scheduler='linear', weight_decay=0.0005, augmentations='default', privacy={'clip': None, 'noise': None, 'distribution': None}, validate=10, novel_defense=None, mixing_method=None, adaptive_attack=True, defend_features_only=False)
Validaion 1 with seed 2543789753...
Epoch: 1  | lr: 0.0001 | Training loss:  0.3637, Training accuracy: 89.5336% | 
Epoch: 2  | lr: 0.0001 | Training loss:  0.0169, Training accuracy: 99.5960% | 
Epoch: 3  | lr: 0.0001 | Training loss:  0.0119, Training accuracy: 99.6328% | 
Epoch: 4  | lr: 0.0001 | Training loss:  0.0153, Training accuracy: 99.4859% | 
Epoch: 5  | lr: 0.0001 | Training loss:  0.0490, Training accuracy: 98.8615% | 
Epoch: 6  | lr: 0.0001 | Training loss:  0.0409, Training accuracy: 99.0452% | 
Epoch: 7  | lr: 0.0001 | Training loss:  0.0183, Training accuracy: 99.5226% | 
Epoch: 8  | lr: 0.0001 | Training loss:  0.0122, Training accuracy: 99.6695% | 
Epoch: 9  | lr: 0.0001 | Training loss:  0.0058, Training accuracy: 99.8531% | 
Epoch: 10 | lr: 0.0001 | Training loss:  0.0040, Training accuracy: 99.8898% | 
------------- Validation -------------
Validation  loss :  0.1193 | Validation accuracy: 95.5423%
Target val. acc  : 100.0000% | Source val accuracy: 95.0658%
Source class: 0
Backdoor loss: 13.3223 | Backdoor acc: 0.0000%
Clean    loss:  0.4438 | Clean    acc: 83.2579%
Source class: 2
Backdoor loss:  2.6291 | Backdoor acc: 24.5763%
Clean    loss:  3.4251 | Clean    acc: 4.2373%
Source class: 3
Backdoor loss:  8.1727 | Backdoor acc: 1.2821%
Clean    loss:  3.6363 | Clean    acc: 42.3077%
Source class: 4
Backdoor loss: 10.5113 | Backdoor acc: 0.0000%
Clean    loss:  0.2002 | Clean    acc: 94.1177%
Source class: 5
Backdoor loss:  5.7656 | Backdoor acc: 3.1250%
Clean    loss:  3.0678 | Clean    acc: 28.9062%
Source class: 6
Backdoor loss:  7.4815 | Backdoor acc: 0.0000%
Clean    loss:  3.9945 | Clean    acc: 36.8794%
Source class: 7
Backdoor loss:  5.2426 | Backdoor acc: 3.4483%
Clean    loss:  1.9428 | Clean    acc: 45.9770%
Source class: 8
Backdoor loss: 11.5851 | Backdoor acc: 0.4049%
Clean    loss:  0.8361 | Clean    acc: 78.5425%
Source class: 9
Backdoor loss:  7.9951 | Backdoor acc: 1.4563%
Clean    loss:  0.1111 | Clean    acc: 97.5728%
Average:
Backdoor loss:  8.8265 | Backdoor acc: 3.0873%
Clean    loss:  1.6270 | Clean    acc: 63.4036%
--------------------------------------
Epoch: 11 | lr: 0.0001 | Training loss:  0.0449, Training accuracy: 98.7514% | 
Epoch: 12 | lr: 0.0001 | Training loss:  0.0231, Training accuracy: 99.3390% | 
Epoch: 13 | lr: 0.0001 | Training loss:  0.0281, Training accuracy: 99.3390% | 
Epoch: 14 | lr: 0.0000 | Training loss:  0.0260, Training accuracy: 99.5960% | 
Epoch: 15 | lr: 0.0000 | Training loss:  0.0054, Training accuracy: 99.7429% | 
Epoch: 16 | lr: 0.0000 | Training loss:  0.0020, Training accuracy: 100.0000% | 
Epoch: 17 | lr: 0.0000 | Training loss:  0.0025, Training accuracy: 99.9633% | 
Epoch: 18 | lr: 0.0000 | Training loss:  0.0022, Training accuracy: 99.9633% | 
Epoch: 19 | lr: 0.0000 | Training loss:  0.0018, Training accuracy: 100.0000% | 
Epoch: 20 | lr: 0.0000 | Training loss:  0.0012, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.1094 | Validation accuracy: 96.1367%
Target val. acc  : 100.0000% | Source val accuracy: 95.7237%
Source class: 0
Backdoor loss:  8.1406 | Backdoor acc: 9.5023%
Clean    loss:  0.5026 | Clean    acc: 85.0679%
Source class: 2
Backdoor loss:  3.1852 | Backdoor acc: 29.6610%
Clean    loss:  0.7130 | Clean    acc: 70.3390%
Source class: 3
Backdoor loss:  2.9442 | Backdoor acc: 23.0769%
Clean    loss:  2.6871 | Clean    acc: 28.2051%
Source class: 4
Backdoor loss: 11.3482 | Backdoor acc: 0.0000%
Clean    loss:  0.0535 | Clean    acc: 99.0196%
Source class: 5
Backdoor loss:  1.6471 | Backdoor acc: 64.0625%
Clean    loss:  4.2180 | Clean    acc: 27.3438%
Source class: 6
Backdoor loss:  3.4456 | Backdoor acc: 19.8582%
Clean    loss:  3.9327 | Clean    acc: 26.9504%
Source class: 7
Backdoor loss:  1.6838 | Backdoor acc: 43.6782%
Clean    loss:  6.0669 | Clean    acc: 1.1494%
Source class: 8
Backdoor loss: 10.7424 | Backdoor acc: 17.0040%
Clean    loss:  1.0504 | Clean    acc: 82.9960%
Source class: 9
Backdoor loss:  3.9527 | Backdoor acc: 29.1262%
Clean    loss:  1.0980 | Clean    acc: 57.7670%
Average:
Backdoor loss:  5.9283 | Backdoor acc: 24.3976%
Clean    loss:  1.8962 | Clean    acc: 59.6386%
--------------------------------------
Epoch: 21 | lr: 0.0000 | Training loss:  0.0015, Training accuracy: 99.9633% | 
Epoch: 22 | lr: 0.0000 | Training loss:  0.0010, Training accuracy: 100.0000% | 
Epoch: 23 | lr: 0.0000 | Training loss:  0.0008, Training accuracy: 100.0000% | 
Epoch: 24 | lr: 0.0000 | Training loss:  0.0009, Training accuracy: 99.9633% | 
Epoch: 25 | lr: 0.0000 | Training loss:  0.0009, Training accuracy: 100.0000% | 
Epoch: 26 | lr: 0.0000 | Training loss:  0.0011, Training accuracy: 99.9633% | 
Epoch: 27 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 100.0000% | 
Epoch: 28 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 100.0000% | 
Epoch: 29 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 100.0000% | 
Epoch: 30 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.0855 | Validation accuracy: 97.0282%
Target val. acc  : 100.0000% | Source val accuracy: 96.7105%
Source class: 0
Backdoor loss:  8.3330 | Backdoor acc: 5.4299%
Clean    loss:  0.5332 | Clean    acc: 83.2579%
Source class: 2
Backdoor loss:  3.5615 | Backdoor acc: 22.8814%
Clean    loss:  0.5686 | Clean    acc: 77.1186%
Source class: 3
Backdoor loss:  3.0279 | Backdoor acc: 20.5128%
Clean    loss:  2.6274 | Clean    acc: 28.2051%
Source class: 4
Backdoor loss: 12.0484 | Backdoor acc: 0.0000%
Clean    loss:  0.0513 | Clean    acc: 99.0196%
Source class: 5
Backdoor loss:  2.0120 | Backdoor acc: 61.7188%
Clean    loss:  3.9146 | Clean    acc: 30.4688%
Source class: 6
Backdoor loss:  3.6082 | Backdoor acc: 18.4397%
Clean    loss:  3.8779 | Clean    acc: 27.6596%
Source class: 7
Backdoor loss:  1.9139 | Backdoor acc: 39.0805%
Clean    loss:  6.3636 | Clean    acc: 1.1494%
Source class: 8
Backdoor loss: 11.0698 | Backdoor acc: 17.0040%
Clean    loss:  1.0722 | Clean    acc: 82.9960%
Source class: 9
Backdoor loss:  3.9587 | Backdoor acc: 30.0971%
Clean    loss:  1.1676 | Clean    acc: 55.3398%
Average:
Backdoor loss:  6.1819 | Backdoor acc: 22.4398%
Clean    loss:  1.8840 | Clean    acc: 59.9398%
--------------------------------------
False positive rate: 23.1429% | Suspicion rate: 12.5694%

Tuesday, 09. January 2024 09:47PM
---------------------------------------------------
Finished computations with train time: 0:06:00.088181
Finished computations with craft time: 0:00:00.005241
Finished computations with test time: 0:04:47.600009
-------------------Job finished.-------------------
