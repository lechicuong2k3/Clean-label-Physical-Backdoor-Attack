ResNet50 model initialized with random key 23456.
Hyperparameters(name='conservative', epochs=40, batch_size=64, optimizer='Adam', lr=0.0001, scheduler='linear', weight_decay=0.0005, augmentations='default', privacy={'clip': None, 'noise': None, 'distribution': None}, validate=10, novel_defense=None, mixing_method=None, adaptive_attack=True, defend_features_only=False)
Preparing dataset from source class for crafting poisons...
Number of samples that can be selected for poisoning is 220
Starting clean training with finetuning scenario ...
Model already exists, skipping training.
Feature representation saved.

Selecting poisons ...
Selections strategy is max_gradient
44 poisons with maximum gradients selected
Updating Kettle poison related fields ...

--------------- Poisoning setup ---------------
--Target/Poison class: 4 (long)
--Threat model: clean-single-source
--Poison selection: max_gradient
--Alpha: 44 images - 20.00% of target-class trainset and 1.65% of total trainset
--Beta: 0 images - 0.00% of target-class trainset

--Source class: 5 (nhan)
--Attacker's source_trainset: 230 images
--Attacker's source_testset: 230 images
----------------------------------------------

Source Grad Norm is 163.56149291992188
Poisoning number 0
Iteration 0 | Poisoning learning rate: 0.09997557473810371 | Passenger loss: 10.3973
Iteration 10 | Poisoning learning rate: 0.09707359806323416 | Passenger loss: 5.9750
Iteration 20 | Poisoning learning rate: 0.08961267311259667 | Passenger loss: 4.8463
Iteration 30 | Poisoning learning rate: 0.07832312720368048 | Passenger loss: 5.4174
Iteration 40 | Poisoning learning rate: 0.06431005974894186 | Passenger loss: 4.8453
Iteration 50 | Poisoning learning rate: 0.04894516742563265 | Passenger loss: 5.3232
Iteration 60 | Poisoning learning rate: 0.03373247294785808 | Passenger loss: 4.5699
Iteration 70 | Poisoning learning rate: 0.02016110084417766 | Passenger loss: 4.4491
Iteration 80 | Poisoning learning rate: 0.009559511573409195 | Passenger loss: 4.0564
Iteration 90 | Poisoning learning rate: 0.002965462558991324 | Passenger loss: 3.7096
Iteration 100 | Poisoning learning rate: 0.09997557473810371 | Passenger loss: 3.7275
Iteration 110 | Poisoning learning rate: 0.09707359806323416 | Passenger loss: 4.8866
Iteration 120 | Poisoning learning rate: 0.08961267311259667 | Passenger loss: 4.7332
Iteration 130 | Poisoning learning rate: 0.07832312720368048 | Passenger loss: 5.2877
Iteration 140 | Poisoning learning rate: 0.06431005974894186 | Passenger loss: 4.6478
Iteration 150 | Poisoning learning rate: 0.04894516742563265 | Passenger loss: 5.5598
Iteration 160 | Poisoning learning rate: 0.03373247294785808 | Passenger loss: 5.4205
Iteration 170 | Poisoning learning rate: 0.02016110084417766 | Passenger loss: 4.3214
Iteration 180 | Poisoning learning rate: 0.009559511573409195 | Passenger loss: 4.2152
Iteration 190 | Poisoning learning rate: 0.002965462558991324 | Passenger loss: 3.3929
Iteration 200 | Poisoning learning rate: 0.09997557473810371 | Passenger loss: 3.3695
Iteration 210 | Poisoning learning rate: 0.09707359806323416 | Passenger loss: 4.8934
Iteration 220 | Poisoning learning rate: 0.08961267311259667 | Passenger loss: 5.2871
Iteration 230 | Poisoning learning rate: 0.07832312720368048 | Passenger loss: 4.8531
Iteration 240 | Poisoning learning rate: 0.06431005974894186 | Passenger loss: 4.5066
Iteration 249 | Poisoning learning rate: 0.0505 | Passenger loss: 3.7792
Poisons with minimal passenger loss 3.7792e+00 selected.

Validating poisoned model...
ResNet50 model initialized with random key 3366970490.
Hyperparameters(name='conservative', epochs=40, batch_size=64, optimizer='Adam', lr=0.0001, scheduler='linear', weight_decay=0.0005, augmentations='default', privacy={'clip': None, 'noise': None, 'distribution': None}, validate=10, novel_defense=None, mixing_method=None, adaptive_attack=True, defend_features_only=False)
Validaion 1 with seed 3366970490...
Epoch: 1  | lr: 0.0001 | Training loss:  0.3787, Training accuracy: 88.7308% | 
Epoch: 2  | lr: 0.0001 | Training loss:  0.0375, Training accuracy: 99.1015% | 
Epoch: 3  | lr: 0.0001 | Training loss:  0.0144, Training accuracy: 99.5133% | 
Epoch: 4  | lr: 0.0001 | Training loss:  0.0142, Training accuracy: 99.4010% | 
Epoch: 5  | lr: 0.0001 | Training loss:  0.0144, Training accuracy: 99.4010% | 
Epoch: 6  | lr: 0.0001 | Training loss:  0.0186, Training accuracy: 99.2887% | 
Epoch: 7  | lr: 0.0001 | Training loss:  0.0298, Training accuracy: 99.1015% | 
Epoch: 8  | lr: 0.0001 | Training loss:  0.0219, Training accuracy: 99.4010% | 
Epoch: 9  | lr: 0.0001 | Training loss:  0.0170, Training accuracy: 99.5882% | 
Epoch: 10 | lr: 0.0001 | Training loss:  0.0078, Training accuracy: 99.7379% | 
------------- Validation -------------
Validation  loss :  0.0689 | Validation accuracy: 97.1768%
Target val. acc  : 100.0000% | Source val accuracy: 97.3333%
Source class: 5
Backdoor loss:  4.3370 | Backdoor acc: 13.0435%
Clean    loss:  5.3022 | Clean    acc: 0.0000%
Average:
Backdoor loss:  4.3370 | Backdoor acc: 13.0435%
Clean    loss:  5.3022 | Clean    acc: 0.0000%
--------------------------------------
Epoch: 11 | lr: 0.0001 | Training loss:  0.0068, Training accuracy: 99.8877% | 
Epoch: 12 | lr: 0.0001 | Training loss:  0.0039, Training accuracy: 99.8877% | 
Epoch: 13 | lr: 0.0001 | Training loss:  0.0053, Training accuracy: 99.8502% | 
Epoch: 14 | lr: 0.0000 | Training loss:  0.0034, Training accuracy: 99.8502% | 
Epoch: 15 | lr: 0.0000 | Training loss:  0.0024, Training accuracy: 99.9626% | 
Epoch: 16 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 99.9626% | 
Epoch: 17 | lr: 0.0000 | Training loss:  0.0008, Training accuracy: 100.0000% | 
Epoch: 18 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 19 | lr: 0.0000 | Training loss:  0.0005, Training accuracy: 100.0000% | 
Epoch: 20 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.0812 | Validation accuracy: 97.6226%
Target val. acc  : 100.0000% | Source val accuracy: 82.6667%
Source class: 5
Backdoor loss:  4.2159 | Backdoor acc: 2.1739%
Clean    loss:  3.4663 | Clean    acc: 5.6522%
Average:
Backdoor loss:  4.2159 | Backdoor acc: 2.1739%
Clean    loss:  3.4663 | Clean    acc: 5.6522%
--------------------------------------
Epoch: 21 | lr: 0.0000 | Training loss:  0.0007, Training accuracy: 100.0000% | 
Epoch: 22 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 23 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 24 | lr: 0.0000 | Training loss:  0.0003, Training accuracy: 100.0000% | 
Epoch: 25 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 26 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 27 | lr: 0.0000 | Training loss:  0.0009, Training accuracy: 99.9626% | 
Epoch: 28 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 29 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 30 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.0746 | Validation accuracy: 97.9198%
Target val. acc  : 100.0000% | Source val accuracy: 84.0000%
Source class: 5
Backdoor loss:  4.4393 | Backdoor acc: 1.3043%
Clean    loss:  3.4409 | Clean    acc: 6.0870%
Average:
Backdoor loss:  4.4393 | Backdoor acc: 1.3043%
Clean    loss:  3.4409 | Clean    acc: 6.0870%
--------------------------------------
False positive rate: 8.7302% | Suspicion rate: 5.0547%
ResNet50 model initialized with random key 1456331056.
Hyperparameters(name='conservative', epochs=40, batch_size=64, optimizer='Adam', lr=0.0001, scheduler='linear', weight_decay=0.0005, augmentations='default', privacy={'clip': None, 'noise': None, 'distribution': None}, validate=10, novel_defense=None, mixing_method=None, adaptive_attack=True, defend_features_only=False)
Validaion 2 with seed 1456331056...
Epoch: 1  | lr: 0.0001 | Training loss:  0.3710, Training accuracy: 88.9180% | 
Epoch: 2  | lr: 0.0001 | Training loss:  0.0418, Training accuracy: 98.8768% | 
Epoch: 3  | lr: 0.0001 | Training loss:  0.0218, Training accuracy: 99.2887% | 
Epoch: 4  | lr: 0.0001 | Training loss:  0.0072, Training accuracy: 99.8128% | 
Epoch: 5  | lr: 0.0001 | Training loss:  0.0389, Training accuracy: 98.8394% | 
Epoch: 6  | lr: 0.0001 | Training loss:  0.0398, Training accuracy: 98.7645% | 
Epoch: 7  | lr: 0.0001 | Training loss:  0.0105, Training accuracy: 99.7379% | 
Epoch: 8  | lr: 0.0001 | Training loss:  0.0147, Training accuracy: 99.6256% | 
Epoch: 9  | lr: 0.0001 | Training loss:  0.0074, Training accuracy: 99.9251% | 
Epoch: 10 | lr: 0.0001 | Training loss:  0.0018, Training accuracy: 99.9626% | 
------------- Validation -------------
Validation  loss :  0.0665 | Validation accuracy: 97.6226%
Target val. acc  : 100.0000% | Source val accuracy: 90.6667%
Source class: 5
Backdoor loss:  5.8442 | Backdoor acc: 0.0000%
Clean    loss:  4.0781 | Clean    acc: 2.6087%
Average:
Backdoor loss:  5.8442 | Backdoor acc: 0.0000%
Clean    loss:  4.0781 | Clean    acc: 2.6087%
--------------------------------------
Epoch: 11 | lr: 0.0001 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 12 | lr: 0.0001 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 13 | lr: 0.0001 | Training loss:  0.0005, Training accuracy: 100.0000% | 
Epoch: 14 | lr: 0.0000 | Training loss:  0.0005, Training accuracy: 100.0000% | 
Epoch: 15 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 16 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 17 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 18 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 19 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 99.9626% | 
Epoch: 20 | lr: 0.0000 | Training loss:  0.0003, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.0693 | Validation accuracy: 97.3254%
Target val. acc  : 100.0000% | Source val accuracy: 90.6667%
Source class: 5
Backdoor loss:  6.6807 | Backdoor acc: 0.0000%
Clean    loss:  5.2481 | Clean    acc: 0.0000%
Average:
Backdoor loss:  6.6807 | Backdoor acc: 0.0000%
Clean    loss:  5.2481 | Clean    acc: 0.0000%
--------------------------------------
Epoch: 21 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 22 | lr: 0.0000 | Training loss:  0.0007, Training accuracy: 100.0000% | 
Epoch: 23 | lr: 0.0000 | Training loss:  0.0001, Training accuracy: 100.0000% | 
Epoch: 24 | lr: 0.0000 | Training loss:  0.0001, Training accuracy: 100.0000% | 
Epoch: 25 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 26 | lr: 0.0000 | Training loss:  0.0001, Training accuracy: 100.0000% | 
Epoch: 27 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 28 | lr: 0.0000 | Training loss:  0.0002, Training accuracy: 100.0000% | 
Epoch: 29 | lr: 0.0000 | Training loss:  0.0001, Training accuracy: 100.0000% | 
Epoch: 30 | lr: 0.0000 | Training loss:  0.0003, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.0612 | Validation accuracy: 97.6226%
Target val. acc  : 100.0000% | Source val accuracy: 92.0000%
Source class: 5
Backdoor loss:  6.0524 | Backdoor acc: 0.0000%
Clean    loss:  4.5077 | Clean    acc: 0.8696%
Average:
Backdoor loss:  6.0524 | Backdoor acc: 0.0000%
Clean    loss:  4.5077 | Clean    acc: 0.8696%
--------------------------------------
False positive rate: 14.4841% | Suspicion rate: 6.5614%
ResNet50 model initialized with random key 450140882.
Hyperparameters(name='conservative', epochs=40, batch_size=64, optimizer='Adam', lr=0.0001, scheduler='linear', weight_decay=0.0005, augmentations='default', privacy={'clip': None, 'noise': None, 'distribution': None}, validate=10, novel_defense=None, mixing_method=None, adaptive_attack=True, defend_features_only=False)
Validaion 3 with seed 450140882...
Epoch: 1  | lr: 0.0001 | Training loss:  0.3258, Training accuracy: 90.9023% | 
Epoch: 2  | lr: 0.0001 | Training loss:  0.0325, Training accuracy: 99.0266% | 
Epoch: 3  | lr: 0.0001 | Training loss:  0.0220, Training accuracy: 99.4384% | 
Epoch: 4  | lr: 0.0001 | Training loss:  0.0108, Training accuracy: 99.6256% | 
Epoch: 5  | lr: 0.0001 | Training loss:  0.0209, Training accuracy: 99.2887% | 
Epoch: 6  | lr: 0.0001 | Training loss:  0.0385, Training accuracy: 98.8394% | 
Epoch: 7  | lr: 0.0001 | Training loss:  0.0245, Training accuracy: 99.2887% | 
Epoch: 8  | lr: 0.0001 | Training loss:  0.0179, Training accuracy: 99.3635% | 
Epoch: 9  | lr: 0.0001 | Training loss:  0.0104, Training accuracy: 99.6630% | 
Epoch: 10 | lr: 0.0001 | Training loss:  0.0250, Training accuracy: 99.4010% | 
------------- Validation -------------
Validation  loss :  0.5068 | Validation accuracy: 86.6270%
Target val. acc  : 100.0000% | Source val accuracy: 80.0000%
Source class: 5
Backdoor loss:  3.9465 | Backdoor acc: 10.4348%
Clean    loss:  5.3325 | Clean    acc: 0.0000%
Average:
Backdoor loss:  3.9465 | Backdoor acc: 10.4348%
Clean    loss:  5.3325 | Clean    acc: 0.0000%
--------------------------------------
Epoch: 11 | lr: 0.0001 | Training loss:  0.0106, Training accuracy: 99.6630% | 
Epoch: 12 | lr: 0.0001 | Training loss:  0.0025, Training accuracy: 100.0000% | 
Epoch: 13 | lr: 0.0001 | Training loss:  0.0033, Training accuracy: 99.8877% | 
Epoch: 14 | lr: 0.0000 | Training loss:  0.0129, Training accuracy: 99.5507% | 
Epoch: 15 | lr: 0.0000 | Training loss:  0.0111, Training accuracy: 99.7379% | 
Epoch: 16 | lr: 0.0000 | Training loss:  0.0013, Training accuracy: 100.0000% | 
Epoch: 17 | lr: 0.0000 | Training loss:  0.0028, Training accuracy: 99.9626% | 
Epoch: 18 | lr: 0.0000 | Training loss:  0.0015, Training accuracy: 99.9626% | 
Epoch: 19 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 100.0000% | 
Epoch: 20 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.0745 | Validation accuracy: 97.4740%
Target val. acc  : 100.0000% | Source val accuracy: 89.3333%
Source class: 5
Backdoor loss:  3.7524 | Backdoor acc: 3.9130%
Clean    loss:  5.1372 | Clean    acc: 0.0000%
Average:
Backdoor loss:  3.7524 | Backdoor acc: 3.9130%
Clean    loss:  5.1372 | Clean    acc: 0.0000%
--------------------------------------
Epoch: 21 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 100.0000% | 
Epoch: 22 | lr: 0.0000 | Training loss:  0.0004, Training accuracy: 100.0000% | 
Epoch: 23 | lr: 0.0000 | Training loss:  0.0007, Training accuracy: 100.0000% | 
Epoch: 24 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 100.0000% | 
Epoch: 25 | lr: 0.0000 | Training loss:  0.0006, Training accuracy: 100.0000% | 
Epoch: 26 | lr: 0.0000 | Training loss:  0.0009, Training accuracy: 100.0000% | 
Epoch: 27 | lr: 0.0000 | Training loss:  0.0005, Training accuracy: 100.0000% | 
Epoch: 28 | lr: 0.0000 | Training loss:  0.0003, Training accuracy: 100.0000% | 
Epoch: 29 | lr: 0.0000 | Training loss:  0.0003, Training accuracy: 100.0000% | 
Epoch: 30 | lr: 0.0000 | Training loss:  0.0003, Training accuracy: 100.0000% | 
------------- Validation -------------
Validation  loss :  0.0668 | Validation accuracy: 97.3254%
Target val. acc  : 100.0000% | Source val accuracy: 89.3333%
Source class: 5
Backdoor loss:  3.4768 | Backdoor acc: 6.9565%
Clean    loss:  4.8949 | Clean    acc: 0.0000%
Average:
Backdoor loss:  3.4768 | Backdoor acc: 6.9565%
Clean    loss:  4.8949 | Clean    acc: 0.0000%
--------------------------------------
False positive rate: 25.7937% | Suspicion rate: 8.2139%

Tuesday, 09. January 2024 10:22AM
---------------------------------------------------
Finished computations with train time: 0:00:00.135147
Finished computations with craft time: 0:06:23.102358
Finished computations with test time: 0:08:16.572095
-------------------Job finished.-------------------
